Running Start

> doc-writer@1.0.0 start /opt/doc-executor
> NODE_PATH=app/src node app/index.js

{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Initializing doc-executor","time":"2019-01-08T15:14:28.948Z","src":{"file":"/opt/doc-executor/app/src/app.js","line":3},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Connecting to queue DOC-STATUS","time":"2019-01-08T15:14:29.019Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":13,"func":"StatusQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Connecting to queue DOC-DATA","time":"2019-01-08T15:14:29.359Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":17,"func":"DataQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Connecting to queue DOC-EXECUTOR-TASKS","time":"2019-01-08T15:14:29.583Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":20,"func":"ExecutorQueueService"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Connected","time":"2019-01-08T15:14:29.648Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":16,"func":"StatusQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Connected","time":"2019-01-08T15:14:29.650Z","src":{"file":"/opt/doc-executor/app/src/services/data-queue.service.js","line":20,"func":"DataQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":" [*] Waiting for messages in DOC-EXECUTOR-TASKS","time":"2019-01-08T15:14:29.650Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":40,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Connected","time":"2019-01-08T15:14:29.651Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":23,"func":"ExecutorQueueService.init.then"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Message received {\"id\":\"b44edcdf-8395-44d0-946c-ad1be56de9c0\",\"type\":\"EXECUTION_CREATE\",\"taskId\":\"a3d109c4-3d95-41a3-897f-defd3666ea29\",\"datasetId\":\"21726b17-6172-4695-8715-837d8445a178\",\"fileUrl\":\"https://proxy.hxlstandard.org/data.json?url=http%3A//ngoaidmap.org/downloads%3Fdoc%3Dcsv%26geolocation%3Dgn_69543%26level%3D0%26name%3Dactivities.csv%26status%3Dactive&stub=ngoaidmap-yem&tagger-20-header=actual_project_reach&tagger-11-tag=%23sector%2Blist&tagger-28-tag=%23meta%2Burl&tagger-15-tag=%23date%2Bbudget&tagger-23-header=location&tagger-13-header=budget_numeric&tagger-32-tag=%23org%2Bdonor%2Blist&tagger-25-tag=%23contact%2Brole&tagger-19-header=target_project_reach&tagger-27-header=project_contact_phone_number&tagger-09-tag=%23date%2Bstart&tagger-13-tag=%23budget%2Bnum&cut-exclude-tags01=contact&header-row=1&tagger-07-header=activities&tagger-27-tag=%23contact%2Bphone&tagger-15-header=budget_value_date&tagger-10-tag=%23date%2Bend&tagger-22-header=target_groups&tagger-04-header=project_tags&tagger-06-tag=%23activity%2Bdescription&tagger-02-header=interaction_intervention_id&tagger-06-header=project_description&tagger-18-tag=%23org%2Bprime&tagger-11-header=sectors&tagger-10-header=end_date&tagger-19-tag=%23targeted%2Bnum&tagger-09-header=start_date&tagger-16-tag=%23org%2Bpartner%2Binternational%2Blist&tagger-29-header=date_provided&tagger-12-tag=%23subsector%2Bcrosscut&tagger-17-header=local_partners&tagger-04-tag=%23meta%2Btags&tagger-12-header=cross_cutting_issues&tagger-05-header=project_name&tagger-01-header=organization&tagger-30-tag=%23date%2Bupdated&tagger-07-tag=%23activity%2Bdetails&tagger-26-header=project_contact_email&tagger-08-header=additional_information&tagger-05-tag=%23activity%2Bname&tagger-31-tag=%23status%2Bcode&force=on&tagger-24-header=project_contact_person&tagger-14-header=budget_currency&tagger-01-tag=%23org%2Bimplementing%2Bname&tagger-14-tag=%23budget%2Bcurrency&tagger-29-tag=%23date%2Bprovided&tagger-03-header=org_intervention_id&tagger-30-header=date_updated&tagger-21-header=project_reach_unit&tagger-02-tag=%23meta%2Bid%2Binteraction&tagger-20-tag=%23reached%2Bnum&tagger-21-tag=%23targeted%2Btype&tagger-31-header=status&tagger-22-tag=%23targeted%2Bdescription&tagger-03-tag=%23meta%2Bid%2Borg&tagger-25-header=project_contact_position&tagger-32-header=donors&tagger-23-tag=%23loc&filter01=cut&tagger-16-header=international+partners&tagger-24-tag=%23contact%2Bname&tagger-28-header=project_website&tagger-08-tag=%23meta%2Bnotes&tagger-17-tag=%23org%2Bpartner%2Blocal%2Blist&tagger-26-tag=%23contact%2Bemail&tagger-18-header=prime_awardee\",\"provider\":\"csv\",\"legend\":{\"nested\":[],\"country\":[],\"region\":[],\"date\":[]},\"verified\":false,\"dataPath\":null}","time":"2019-01-08T15:14:29.653Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":66,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"message content { id: 'b44edcdf-8395-44d0-946c-ad1be56de9c0',\n  type: 'EXECUTION_CREATE',\n  taskId: 'a3d109c4-3d95-41a3-897f-defd3666ea29',\n  datasetId: '21726b17-6172-4695-8715-837d8445a178',\n  fileUrl: 'https://proxy.hxlstandard.org/data.json?url=http%3A//ngoaidmap.org/downloads%3Fdoc%3Dcsv%26geolocation%3Dgn_69543%26level%3D0%26name%3Dactivities.csv%26status%3Dactive&stub=ngoaidmap-yem&tagger-20-header=actual_project_reach&tagger-11-tag=%23sector%2Blist&tagger-28-tag=%23meta%2Burl&tagger-15-tag=%23date%2Bbudget&tagger-23-header=location&tagger-13-header=budget_numeric&tagger-32-tag=%23org%2Bdonor%2Blist&tagger-25-tag=%23contact%2Brole&tagger-19-header=target_project_reach&tagger-27-header=project_contact_phone_number&tagger-09-tag=%23date%2Bstart&tagger-13-tag=%23budget%2Bnum&cut-exclude-tags01=contact&header-row=1&tagger-07-header=activities&tagger-27-tag=%23contact%2Bphone&tagger-15-header=budget_value_date&tagger-10-tag=%23date%2Bend&tagger-22-header=target_groups&tagger-04-header=project_tags&tagger-06-tag=%23activity%2Bdescription&tagger-02-header=interaction_intervention_id&tagger-06-header=project_description&tagger-18-tag=%23org%2Bprime&tagger-11-header=sectors&tagger-10-header=end_date&tagger-19-tag=%23targeted%2Bnum&tagger-09-header=start_date&tagger-16-tag=%23org%2Bpartner%2Binternational%2Blist&tagger-29-header=date_provided&tagger-12-tag=%23subsector%2Bcrosscut&tagger-17-header=local_partners&tagger-04-tag=%23meta%2Btags&tagger-12-header=cross_cutting_issues&tagger-05-header=project_name&tagger-01-header=organization&tagger-30-tag=%23date%2Bupdated&tagger-07-tag=%23activity%2Bdetails&tagger-26-header=project_contact_email&tagger-08-header=additional_information&tagger-05-tag=%23activity%2Bname&tagger-31-tag=%23status%2Bcode&force=on&tagger-24-header=project_contact_person&tagger-14-header=budget_currency&tagger-01-tag=%23org%2Bimplementing%2Bname&tagger-14-tag=%23budget%2Bcurrency&tagger-29-tag=%23date%2Bprovided&tagger-03-header=org_intervention_id&tagger-30-header=date_updated&tagger-21-header=project_reach_unit&tagger-02-tag=%23meta%2Bid%2Binteraction&tagger-20-tag=%23reached%2Bnum&tagger-21-tag=%23targeted%2Btype&tagger-31-header=status&tagger-22-tag=%23targeted%2Bdescription&tagger-03-tag=%23meta%2Bid%2Borg&tagger-25-header=project_contact_position&tagger-32-header=donors&tagger-23-tag=%23loc&filter01=cut&tagger-16-header=international+partners&tagger-24-tag=%23contact%2Bname&tagger-28-header=project_website&tagger-08-tag=%23meta%2Bnotes&tagger-17-tag=%23org%2Bpartner%2Blocal%2Blist&tagger-26-tag=%23contact%2Bemail&tagger-18-header=prime_awardee',\n  provider: 'csv',\n  legend: { nested: [], country: [], region: [], date: [] },\n  verified: false,\n  dataPath: null }","time":"2019-01-08T15:14:29.653Z","src":{"file":"/opt/doc-executor/app/src/services/executor-queue.service.js","line":68,"func":"consume"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Create task","time":"2019-01-08T15:14:29.654Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":60,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Creating index","time":"2019-01-08T15:14:29.654Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":61,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Creating index index_21726b17617246958715837d8445a178_1546960469654 and type type in elastic","time":"2019-01-08T15:14:29.654Z","src":{"file":"/opt/doc-executor/app/src/services/elastic.service.js","line":54,"func":"createIndex"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Sending index created message of taskId a3d109c4-3d95-41a3-897f-defd3666ea29 and index index_21726b17617246958715837d8445a178_1546960469654","time":"2019-01-08T15:14:36.862Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":56,"func":"sendIndexCreated"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Sending message IndexCreatedMessage {\n  id: '634a54fb-f41a-49ed-94b7-064463a4a16a',\n  type: 'STATUS_INDEX_CREATED',\n  taskId: 'a3d109c4-3d95-41a3-897f-defd3666ea29',\n  index: 'index_21726b17617246958715837d8445a178_1546960469654' }","time":"2019-01-08T15:14:38.864Z","src":{"file":"/opt/doc-executor/app/src/services/status-queue.service.js","line":37,"func":"setInterval"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Starting importing service","time":"2019-01-08T15:14:38.868Z","src":{"file":"/opt/doc-executor/app/src/services/executor.service.js","line":69,"func":"create"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Starting read file","time":"2019-01-08T15:14:38.868Z","src":{"file":"/opt/doc-executor/app/src/services/importer.service.js","line":52,"func":"Promise"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Getting converter of type csv and dataPath null and url https://proxy.hxlstandard.org/data.json?url=http%3A//ngoaidmap.org/downloads%3Fdoc%3Dcsv%26geolocation%3Dgn_69543%26level%3D0%26name%3Dactivities.csv%26status%3Dactive&stub=ngoaidmap-yem&tagger-20-header=actual_project_reach&tagger-11-tag=%23sector%2Blist&tagger-28-tag=%23meta%2Burl&tagger-15-tag=%23date%2Bbudget&tagger-23-header=location&tagger-13-header=budget_numeric&tagger-32-tag=%23org%2Bdonor%2Blist&tagger-25-tag=%23contact%2Brole&tagger-19-header=target_project_reach&tagger-27-header=project_contact_phone_number&tagger-09-tag=%23date%2Bstart&tagger-13-tag=%23budget%2Bnum&cut-exclude-tags01=contact&header-row=1&tagger-07-header=activities&tagger-27-tag=%23contact%2Bphone&tagger-15-header=budget_value_date&tagger-10-tag=%23date%2Bend&tagger-22-header=target_groups&tagger-04-header=project_tags&tagger-06-tag=%23activity%2Bdescription&tagger-02-header=interaction_intervention_id&tagger-06-header=project_description&tagger-18-tag=%23org%2Bprime&tagger-11-header=sectors&tagger-10-header=end_date&tagger-19-tag=%23targeted%2Bnum&tagger-09-header=start_date&tagger-16-tag=%23org%2Bpartner%2Binternational%2Blist&tagger-29-header=date_provided&tagger-12-tag=%23subsector%2Bcrosscut&tagger-17-header=local_partners&tagger-04-tag=%23meta%2Btags&tagger-12-header=cross_cutting_issues&tagger-05-header=project_name&tagger-01-header=organization&tagger-30-tag=%23date%2Bupdated&tagger-07-tag=%23activity%2Bdetails&tagger-26-header=project_contact_email&tagger-08-header=additional_information&tagger-05-tag=%23activity%2Bname&tagger-31-tag=%23status%2Bcode&force=on&tagger-24-header=project_contact_person&tagger-14-header=budget_currency&tagger-01-tag=%23org%2Bimplementing%2Bname&tagger-14-tag=%23budget%2Bcurrency&tagger-29-tag=%23date%2Bprovided&tagger-03-header=org_intervention_id&tagger-30-header=date_updated&tagger-21-header=project_reach_unit&tagger-02-tag=%23meta%2Bid%2Binteraction&tagger-20-tag=%23reached%2Bnum&tagger-21-tag=%23targeted%2Btype&tagger-31-header=status&tagger-22-tag=%23targeted%2Bdescription&tagger-03-tag=%23meta%2Bid%2Borg&tagger-25-header=project_contact_position&tagger-32-header=donors&tagger-23-tag=%23loc&filter01=cut&tagger-16-header=international+partners&tagger-24-tag=%23contact%2Bname&tagger-28-header=project_website&tagger-08-tag=%23meta%2Bnotes&tagger-17-tag=%23org%2Bpartner%2Blocal%2Blist&tagger-26-tag=%23contact%2Bemail&tagger-18-header=prime_awardee","time":"2019-01-08T15:14:38.868Z","src":{"file":"/opt/doc-executor/app/src/services/converters/converterFactory.js","line":10,"func":"getInstance"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Is a url. Downloading file","time":"2019-01-08T15:14:38.869Z","src":{"file":"/opt/doc-executor/app/src/services/converters/csvConverter.js","line":30,"func":"init"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"Checking if the url https://proxy.hxlstandard.org/data.json?url=http%3A//ngoaidmap.org/downloads%3Fdoc%3Dcsv%26geolocation%3Dgn_69543%26level%3D0%26name%3Dactivities.csv%26status%3Dactive&stub=ngoaidmap-yem&tagger-20-header=actual_project_reach&tagger-11-tag=%23sector%2Blist&tagger-28-tag=%23meta%2Burl&tagger-15-tag=%23date%2Bbudget&tagger-23-header=location&tagger-13-header=budget_numeric&tagger-32-tag=%23org%2Bdonor%2Blist&tagger-25-tag=%23contact%2Brole&tagger-19-header=target_project_reach&tagger-27-header=project_contact_phone_number&tagger-09-tag=%23date%2Bstart&tagger-13-tag=%23budget%2Bnum&cut-exclude-tags01=contact&header-row=1&tagger-07-header=activities&tagger-27-tag=%23contact%2Bphone&tagger-15-header=budget_value_date&tagger-10-tag=%23date%2Bend&tagger-22-header=target_groups&tagger-04-header=project_tags&tagger-06-tag=%23activity%2Bdescription&tagger-02-header=interaction_intervention_id&tagger-06-header=project_description&tagger-18-tag=%23org%2Bprime&tagger-11-header=sectors&tagger-10-header=end_date&tagger-19-tag=%23targeted%2Bnum&tagger-09-header=start_date&tagger-16-tag=%23org%2Bpartner%2Binternational%2Blist&tagger-29-header=date_provided&tagger-12-tag=%23subsector%2Bcrosscut&tagger-17-header=local_partners&tagger-04-tag=%23meta%2Btags&tagger-12-header=cross_cutting_issues&tagger-05-header=project_name&tagger-01-header=organization&tagger-30-tag=%23date%2Bupdated&tagger-07-tag=%23activity%2Bdetails&tagger-26-header=project_contact_email&tagger-08-header=additional_information&tagger-05-tag=%23activity%2Bname&tagger-31-tag=%23status%2Bcode&force=on&tagger-24-header=project_contact_person&tagger-14-header=budget_currency&tagger-01-tag=%23org%2Bimplementing%2Bname&tagger-14-tag=%23budget%2Bcurrency&tagger-29-tag=%23date%2Bprovided&tagger-03-header=org_intervention_id&tagger-30-header=date_updated&tagger-21-header=project_reach_unit&tagger-02-tag=%23meta%2Bid%2Binteraction&tagger-20-tag=%23reached%2Bnum&tagger-21-tag=%23targeted%2Btype&tagger-31-header=status&tagger-22-tag=%23targeted%2Bdescription&tagger-03-tag=%23meta%2Bid%2Borg&tagger-25-header=project_contact_position&tagger-32-header=donors&tagger-23-tag=%23loc&filter01=cut&tagger-16-header=international+partners&tagger-24-tag=%23contact%2Bname&tagger-28-header=project_website&tagger-08-tag=%23meta%2Bnotes&tagger-17-tag=%23org%2Bpartner%2Blocal%2Blist&tagger-26-tag=%23contact%2Bemail&tagger-18-header=prime_awardee exists","time":"2019-01-08T15:14:38.869Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":53,"func":"checkIfExists"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Downloading....","time":"2019-01-08T15:14:38.869Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":71,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Temporal path /tmp/99m6WnYGXlRN1UDndUGwEUXrZqgrmtoA.csv . Downloading","time":"2019-01-08T15:14:38.869Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":73,"func":"downloadFile"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Sending request","time":"2019-01-08T15:14:38.870Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":31},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":30,"msg":"File size: 4.7 KiB","time":"2019-01-08T15:14:39.689Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":35,"func":"download.then.data"},"v":0}
{"name":"doc-executor","hostname":"doc-executor-sdgs-9d45688c5-9zn9n","pid":17,"level":20,"msg":"Downloaded file!!!","time":"2019-01-08T15:14:39.689Z","src":{"file":"/opt/doc-executor/app/src/services/downloadService.js","line":75,"func":"downloadFile"},"v":0}
events.js:193
      throw er; // Unhandled 'error' event
      ^

Error: Parse Error: expected: '"' got: ']'. at '],\n'["#org+
    at parseEscapedItem (/opt/doc-executor/node_modules/fast-csv/lib/parser/parser.js:80:19)
    at ParserStream.parseLine [as parser] (/opt/doc-executor/node_modules/fast-csv/lib/parser/parser.js:192:30)
    at ParserStream._parseLine [as _parse] (/opt/doc-executor/node_modules/fast-csv/lib/parser/parser_stream.js:178:25)
    at ParserStream._transform (/opt/doc-executor/node_modules/fast-csv/lib/parser/parser_stream.js:221:18)
    at ParserStream.Transform._read (_stream_transform.js:185:10)
    at ParserStream.Transform._write (_stream_transform.js:173:12)
    at doWrite (_stream_writable.js:388:12)
    at writeOrBuffer (_stream_writable.js:374:5)
    at ParserStream.Writable.write (_stream_writable.js:291:11)
    at ReadStream.ondata (_stream_readable.js:642:20)
    at emitOne (events.js:125:13)
    at ReadStream.emit (events.js:221:7)
    at addChunk (_stream_readable.js:265:12)
    at readableAddChunk (_stream_readable.js:252:11)
    at ReadStream.Readable.push (_stream_readable.js:209:10)
    at onread (fs.js:2095:12)
    at FSReqWrap.wrapper [as oncomplete] (fs.js:676:17)
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! doc-writer@1.0.0 start: `NODE_PATH=app/src node app/index.js`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the doc-writer@1.0.0 start script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /home/doc-executor/.npm/_logs/2019-01-08T15_14_39_704Z-debug.log
